package org.aries.launcher;

import org.aries.event.tracker.EventTracker;
import org.aries.launcher.MavenApplicationLauncher;
import org.aries.launcher.MavenExecutionHarness;
import org.aries.launcher.MavenProgram;
import org.aries.util.test.AbstractMultiThreadedIT;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.runners.MockitoJUnitRunner;


/**
 * Generated by Nam.
 *
 */
@RunWith(MockitoJUnitRunner.class)
public class MavenApplicationLauncherIT extends AbstractMultiThreadedIT {

	private MavenApplicationLauncher fixture;


	@Before
	public void setUp() throws Exception {
		super.setUp();
		fixture = createFixture();
	}

	@After
	public void tearDown() throws Exception {
		fixture = null;
		super.tearDown();
	}

	protected MavenApplicationLauncher createFixture() throws Exception {
		fixture = new MavenApplicationLauncher(createProgramForTest());
		fixture.setEventTracker(createEventTracker());
		return fixture;
	}

	protected EventTracker createEventTracker() {
		EventTracker eventTracker = new EventTracker();
		return eventTracker;
	}

	protected MavenProgram createProgramForTest() {
		MavenProgram program = new MavenProgram();
		program.setName("maven_application_launcher_test");
		program.setMavenHome("c:/software/apache-maven-3.0.4");
		program.setMainClass(MavenExecutionHarness.class.getName());
		program.addGoal("validate");
		program.setHostName("localhost");
		program.setJmxPort(1199);
		program.initialize();
		return program;
	}

	@Test
	public void testExecution() throws Exception {
		fixture.initialize();
		fixture.start();
		fixture.addWaitToken("BUILD SUCCESS");
		fixture.waitFor();
		fixture.stop();
		//fixture.join();
	}

}
